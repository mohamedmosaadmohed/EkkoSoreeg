@using EkkoSoreeg.Utilities
@model OrderVM
@{
    ViewBag.pageTitle = "Order Management";
    ViewBag.CardTitle = "Details Order";
}
<form method="post">
    <section class="section">
        <div class="row">
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">PickUp Details</h5>
                        <input hidden asp-for="orderHeader.Id" />
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">FirstName</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="firstname" name="orderHeader.FirstName" asp-for="orderHeader.FirstName">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Lastname</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="lastname" name="orderHeader.LastName" asp-for="orderHeader.LastName">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">PhoneNumber</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="phone" name="orderHeader.PhoneNumber" asp-for="orderHeader.PhoneNumber">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Additional Phone</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="additionalphonenumber" name="orderHeader.AdditionalPhoneNumber" asp-for="orderHeader.AdditionalPhoneNumber">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Address</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="address" name="orderHeader.Address" asp-for="orderHeader.Address">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Noties</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="additionalinformation" name="orderHeader.AdditionalInformation" asp-for="orderHeader.AdditionalInformation">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Region</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="region" name="orderHeader.Region" asp-for="orderHeader.Region">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">City</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="city" name="orderHeader.City" asp-for="orderHeader.City">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Email</label>
                            <div class="col-sm-10">
                                <input type="text" disabled class="form-control" id="email" name="orderHeader.Email" asp-for="orderHeader.Email">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Order Date</label>
                            <div class="col-sm-10">
                                <input value="@Model.orderHeader.orderDate.ToShortDateString()" disabled type="text" class="form-control" id="orderDate" name="orderDate">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Carrier</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="carrier" name="orderHeader.Carrier" asp-for="orderHeader.Carrier">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Tracking Number</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="trackingNumber" name="orderHeader.TrackingNumber" asp-for="orderHeader.TrackingNumber">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Shipping Date</label>
                            <div class="col-sm-10">
                                <input value="@Model.orderHeader.shippingDate.ToShortDateString()" type="text" class="form-control" id="shippingDate" name="shippingDate">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Payment Status</label>
                            <div class="col-sm-10">
                                <input disabled type="text" class="form-control" id="paymentStatus" name="orderHeader.paymentStatus" asp-for="orderHeader.paymentStatus">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <label for="inputText" class="col-sm-2 col-form-label">Payment Date</label>
                            <div class="col-sm-10">
                                <input disabled value="@Model.orderHeader.paymentDate.ToShortDateString()" type="text" class="form-control" id="paymentDate" name="paymentDate">
                            </div>
                        </div>
                        <input type="submit" asp-action="UpdateOrderDetails" class="btn btn-primary btn-block" value="Update PickUp" />
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Order Summary</h5>
                        <label class="btn btn-outline-primary form-control mb-4">Order Status - @Model.orderHeader.orderStatus</label>
                        @foreach (var item in Model.orderDetails)
                        {
                            <ul class="list-group mb-3">
                                <li class="list-group-item d-flex justify-content-between">
                                    <strong>Name</strong>
                                    <strong>@item.product.Name</strong>
                                </li>
                                <li class="list-group-item d-flex justify-content-between">
                                    <strong>Price</strong>
                                    <strong>£ @item.product.Price</strong>
                                </li>
                                <li class="list-group-item d-flex justify-content-between">
                                    <strong>Count</strong>
                                    <strong>@item.Count</strong>
                                </li>
                            </ul>
                            <hr />
                        }
                        <ul class="list-group mb-3">
                            <li class="list-group-item d-flex justify-content-between">
                                <strong>Shipping fee:</strong>
                                <strong style="color:#717FE0">£ 50</strong>
                            </li>
                            <li class="list-group-item d-flex justify-content-between">
                                <strong>Total (EGP)</strong>
                                <strong style="color:#717FE0">£ @Model.orderHeader.totalPrice</strong>
                            </li>
                        </ul>
                        @if (Model.orderHeader.orderStatus == SD.Pending)
                        {
                            <input type="submit" class="btn btn-primary m-1" asp-action="ApproveOrder" name="action" value="ApproveOrder" />
                        }
                        @if (Model.orderHeader.orderStatus == SD.Approve)
                        {
                            <input type="submit" class="btn btn-success m-1" onclick="return CheckData()" asp-action="StartShipping" name="action" value="StartShipping" />
                        }
                        @if (Model.orderHeader.orderStatus != SD.Cancelled && Model.orderHeader.orderStatus != SD.Refund)
                        {
                            <button type="submit" class="btn btn-danger m-1" name="action" value="CancelOrder">Cancel Order</button>
                        }
                    </div>
                </div>
            </div>
        </div>
    </section>
</form>




@section Scripts {
    <script>
        function CheckData() {
            if (document.getElementById("carrier").value == '') {
                Swal.fire({
                    title: "There Is An Error",
                    text: "Please Enter Carrier",
                    icon: "error",
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                });
                return false;
            }
            if (document.getElementById("trackingNumber").value == '') {
                Swal.fire({
                    title: "There Is An Error",
                    text: "Please Enter Tracking Number",
                    icon: "error",
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                });
                return false;
            }
            return true;
        }
    </script>
}